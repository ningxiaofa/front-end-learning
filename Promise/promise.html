<!DOCTYPE html>
<html>
<head>
	<title>Promise</title>
</head>
<body>

</body>
</html>



async function getSheetLastDate(sheetId, sheetName, beginDate){
    await rrSheets.tryCreateSheet(sheetId, sheetName);
     let sheetLastDate = moment(await rrSheets.getLastDate(sheetId, sheetName), 'YYYY-MM-DD');
     const date = moment(beginDate, 'YYYY-MM-DD');
     if (sheetLastDate.isBefore(date)) {
       sheetLastDate = date;
     } 
     return sheetLastDate;
}
 

 async function getSheetLastDate(sheetId, sheetName, beginDate){
   await rrSheets.tryCreateSheet(sheetId, sheetName);
    let sheetLastDate = moment(await rrSheets.getLastDate(sheetId, sheetName), 'YYYY-MM-DD');
    const date = moment(beginDate, 'YYYY-MM-DD');
    if (sheetLastDate.isBefore(date)) {
      sheetLastDate = date;
    } 
    return sheetLastDate;
}



// If sheetId not exists, will create.
async function getSheetLastDate(sheetId, sheetName, beginDate){
    await tryCreateSheet(sheetId, sheetName);
     let sheetLastDate = moment(await getLastDate(sheetId, sheetName), 'YYYY-MM-DD');
     const date = moment(beginDate, 'YYYY-MM-DD');
     if (sheetLastDate.isBefore(date)) {
       sheetLastDate = date;
     } 
     return sheetLastDate;
 }